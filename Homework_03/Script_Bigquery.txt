-- Question 1
SELECT count(*)
FROM `de-phannh.trips_data_all.yellow_tripdata_external`;

-- Question 2
SELECT PULocationID
FROM `de-phannh.trips_data_all.yellow_tripdata_external`
GROUP BY PULocationID;

-- Question 3
CREATE OR REPLACE TABLE `de-phannh.trips_data_all.yellow_tripdata_2024_optimized`
PARTITION BY DATE(tpep_pickup_datetime)
CLUSTER BY VendorID AS
SELECT * FROM `de-phannh.trips_data_all.yellow_tripdata_external`;

SELECT PULocationID
FROM `de-phannh.trips_data_all.yellow_tripdata_2024_optimized`;

SELECT PULocationID, DOLocationID
FROM `de-phannh.trips_data_all.yellow_tripdata_2024_optimized`;

-- Question 4
SELECT count(*)
FROM `de-phannh.trips_data_all.yellow_tripdata_2024_optimized`
WHERE fare_amount = 0;

-- Question 6
CREATE OR REPLACE TABLE `de-phannh.trips_data_all.yellow_tripdata_2024_nooptimize` AS
SELECT * FROM `de-phannh.trips_data_all.yellow_tripdata_external`;

SELECT VendorID
FROM `de-phannh.trips_data_all.yellow_tripdata_2024_nooptimize`
WHERE DATE(tpep_dropoff_datetime) between '2024-03-01' and '2024-03-15';

SELECT VendorID
FROM `de-phannh.trips_data_all.yellow_tripdata_2024_optimized`
WHERE DATE(tpep_dropoff_datetime) between '2024-03-01' and '2024-03-15';